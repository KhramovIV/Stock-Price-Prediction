Обзор

Данный проект посвящен оптимизации и выбора наилучшей модели рекуррентых нейронных сетей (RNN) для анализа цен на акции российских компаний ROSN, SBER. Целью работы является повыешения точности предсказания за счёт использования информации о исторических данных о торгах и данных о настроении в новостях. В ходе работы сравнивается эффективность GRU, LSTM и архитектуры с использованием механизма Attention. Тестирование проводилось с использованием новостного сентимента, так и без него.


Pipeline 
1. Сбор данных: Пропаршен сайт РИА-Новости (раздел "Экономика") с 1 января, 2006 по 25 декабря, 2025 (впоследствии обрезан до 2014 года)
2. Предобработка: Очищен полученный датасет. Очистка включала удаление отсутствующих значений, конвертирование в правильный временной формат, создание признаков о состоянии ряда, проведение сентимент анализа.
3. Разработка моделей: Разработаны LSTM, GRU и Attention-Based алгоритмы, чтобы лучше предсказвывать временной ряд на основе предыдущих новостей.
4. Оценка: Произведена оценка моделей используя такие метрики, как RMSE.


Dataset
Временной промежуток: 1 июля, 2014 - 25 декабря, 2025 (11 лет)
Выбор компаний:
  ROSN: Одна из крупнейших российский нефтянных компаний, которая достаточно сильно реагирует на новостной фон 
  SBER: Крупная российская компания в банковской сфере

Источники:
Новости: РИА-Новости Экономика
Цены акций: Московская биржа (с помощью apimoex)



Предобработка:
1. Проверка на пропущенные значения, удаление повторов, преобразование типов
2. Создание сентимента используя FinBERT модель для анализа сентимента mxlcw/rubert-tiny2-russian-financial-sentiment. Новости делились на positive, negative, neutral.
3. Агрегация сентимента по дням, а затем и по нескольким дням, когда биржа не работала.

Создание признаков:
1. Сентимент рассчитывался по формуле sentiment_score = (positive - negative) / (positive + negative + 0.25 * neutral)
2. Были рассчитаны скользящие средние и стандартные отклонения за 7 и 14 дней.
3. Созданы признаки для дня недели, месяца, года.
4. Проведено сглаживание sentiment_score и числа просмотров с помощью экспненциального скользящего среднего
5. Проведен анализ feature importance и отобраны самые значимые признаки.


Модели:


Результаты
